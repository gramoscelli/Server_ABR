import{r as c,j as e,C as g}from"./index-C1GA9Qxv.js";import{C as h}from"./circle-x-DLPO0AQB.js";import{C as j}from"./circle-check-O-Sz6jck.js";function v({password:a,onValidationChange:r}){const[t,d]=c.useState(null),[p,n]=c.useState(!1),[i,x]=c.useState("");if(c.useEffect(()=>{fetch("/api/csrf-token",{credentials:"include"}).then(s=>s.json()).then(s=>x(s.csrfToken)).catch(s=>console.error("Failed to get CSRF token:",s))},[]),c.useEffect(()=>{if(!a||a.length===0){d(null),r==null||r(null),n(!1);return}if(!i)return;const s=setTimeout(async()=>{n(!0);try{const l=await fetch("/api/auth/validate-password",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":i},credentials:"include",body:JSON.stringify({password:a})});if(l.ok){const o=await l.json();d(o),r==null||r(o)}}catch(l){console.error("Password validation error:",l)}finally{n(!1)}},300);return()=>clearTimeout(s)},[a,i,r]),!a||a.length===0||!t)return null;const u=()=>{switch(t.strength){case"excellent":return"bg-green-500";case"strong":return"bg-blue-500";case"good":return"bg-yellow-500";case"fair":return"bg-orange-500";case"weak":return"bg-red-500";default:return"bg-gray-500"}},m=()=>{switch(t.strength){case"excellent":return"text-green-700";case"strong":return"text-blue-700";case"good":return"text-yellow-700";case"fair":return"text-orange-700";case"weak":return"text-red-700";default:return"text-gray-700"}},f=()=>{switch(t.strength){case"excellent":return"Excelente";case"strong":return"Fuerte";case"good":return"Buena";case"fair":return"Regular";case"weak":return"Débil";default:return""}};return e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsxs("span",{className:`font-medium ${m()}`,children:["Fortaleza: ",f()]}),e.jsxs("span",{className:"text-gray-500",children:[t.score,"/100"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${u()}`,style:{width:`${t.score}%`}})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700",children:"Requisitos:"}),e.jsx("div",{className:"space-y-1",children:t.requirements.filter(s=>s.required).map(s=>s.met?e.jsx(e.Fragment,{}):e.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[e.jsx(h,{className:"h-4 w-4 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("span",{className:s.met?"text-gray-600":"text-gray-900",children:[s.label,s.current!==void 0&&s.expected!==void 0&&!s.met&&e.jsxs("span",{className:"text-gray-500 ml-1",children:["(",s.current,"/",s.expected,")"]})]})]},s.name))})]}),t.feedback&&t.feedback.length>0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(g,{className:"h-4 w-4 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-medium text-yellow-800 mb-1",children:"Sugerencias:"}),e.jsx("ul",{className:"text-xs text-yellow-700 space-y-0.5",children:t.feedback.map((s,l)=>e.jsxs("li",{children:["• ",s]},l))})]})]})}),t.valid&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-green-600"}),e.jsx("p",{className:"text-xs text-green-800",children:"✓ La contraseña cumple con todos los requisitos de seguridad"})]})}),t.requirements.find(s=>s.name==="specialChars"&&!s.met)&&e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"font-medium",children:"Caracteres especiales permitidos:"})," ","!@#$%^&*()_+-=[]",";\\':\"|,<>/?~`"]})]})}export{v as P};
//# sourceMappingURL=PasswordStrengthIndicator-Dz6ERkyk.js.map
