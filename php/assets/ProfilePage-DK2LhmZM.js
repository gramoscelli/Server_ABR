import{c as k,r as o,B as P,f as N,j as e,e as h,g as p,h as x,i as b,k as j,E as v}from"./index-B2xrcMBU.js";import{A as f}from"./AdminLayout-e4C_PfH9.js";import{L as l,I as i}from"./label-DSCW4tBn.js";import{U as T}from"./user-BGAYmxY0.js";import{C as D}from"./circle-check-eqNgsW64.js";import{M as R}from"./mail-B6ksPvIN.js";import"./lock-DfNglbML.js";import"./log-out-CVeatBap.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],L=k("phone",I);function H(){const[w,C]=o.useState(!0),[c,g]=o.useState(!1),[a,y]=o.useState(null),[t,n]=o.useState({nombre:"",apellido:"",email:"",whatsapp:""}),{toast:d}=P();o.useEffect(()=>{E()},[]);const E=async()=>{try{const s=await N("/api/auth/me");if(s.ok){const r=await s.json();y(r.user),n({nombre:r.user.nombre||"",apellido:r.user.apellido||"",email:r.user.email||"",whatsapp:r.user.whatsapp||""})}else throw new Error("Failed to load profile")}catch{d({variant:"destructive",title:"Error",description:"No se pudo cargar el perfil"})}finally{C(!1)}},A=async s=>{s.preventDefault(),g(!0);try{const r=await fetch("/api/csrf-token",{credentials:"include"}),{csrfToken:F}=await r.json(),m=await N("/api/auth/profile",{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-Token":F},body:JSON.stringify(t)});if(m.ok){const u=await m.json();y(u.user),d({title:"Éxito",description:"Perfil actualizado correctamente"})}else{const u=await m.json();throw new Error(u.message||"Error al actualizar el perfil")}}catch(r){d({variant:"destructive",title:"Error",description:r instanceof Error?r.message:"Error al actualizar el perfil"})}finally{g(!1)}},S=()=>{a&&n({nombre:a.nombre||"",apellido:a.apellido||"",email:a.email||"",whatsapp:a.whatsapp||""})};return w?e.jsx(f,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Cargando perfil..."})})}):a?e.jsx(f,{children:e.jsxs("div",{className:"space-y-6 max-w-3xl",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mi Perfil"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Administra tu información personal y configuración de cuenta"})]}),e.jsxs(h,{children:[e.jsxs(p,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"Información de la Cuenta"]}),e.jsx(b,{children:"Tu nombre de usuario es único y no puede ser modificado"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"username",children:"Nombre de Usuario"}),e.jsx(i,{id:"username",value:a.username,disabled:!0,className:"bg-gray-100 cursor-not-allowed"}),e.jsx("p",{className:"text-xs text-gray-500",children:"El nombre de usuario no puede ser modificado"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"role",children:"Rol"}),e.jsx(i,{id:"role",value:a.role,disabled:!0,className:"bg-gray-100 cursor-not-allowed"})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx(D,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900",children:a.oauth_only?"Cuenta OAuth":"Información de Seguridad"}),e.jsx("p",{className:"text-sm text-blue-800 mt-1",children:a.oauth_only?"Esta cuenta usa autenticación OAuth. El email está vinculado a tu proveedor OAuth y no puede ser modificado.":"Por seguridad, el email asociado a tu cuenta no puede ser modificado. Si necesitas cambiar tu email, contacta a un administrador."})]})]})]})]}),e.jsxs(h,{children:[e.jsxs(p,{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"Información Personal"]}),e.jsx(b,{children:"Actualiza tus datos personales de contacto"})]}),e.jsx(j,{children:e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"nombre",children:"Nombre"}),e.jsx(i,{id:"nombre",value:t.nombre,onChange:s=>n({...t,nombre:s.target.value}),placeholder:"Tu nombre"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"apellido",children:"Apellido"}),e.jsx(i,{id:"apellido",value:t.apellido,onChange:s=>n({...t,apellido:s.target.value}),placeholder:"Tu apellido"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(i,{id:"email",type:"email",value:t.email,disabled:!0,className:"bg-gray-100 cursor-not-allowed"}),e.jsx("p",{className:"text-xs text-gray-500",children:"El email no puede ser modificado por seguridad. Contacta a un administrador si necesitas cambiarlo."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"whatsapp",className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),"WhatsApp"]}),e.jsx(i,{id:"whatsapp",type:"tel",value:t.whatsapp,onChange:s=>n({...t,whatsapp:s.target.value}),placeholder:"+1234567890"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Formato internacional (ej: +549261234567)"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(v,{type:"submit",disabled:c,className:"flex-1",children:c?"Guardando...":"Guardar Cambios"}),e.jsx(v,{type:"button",variant:"outline",onClick:S,disabled:c,children:"Restablecer"})]})]})})]}),e.jsxs(h,{children:[e.jsx(p,{children:e.jsx(x,{children:"Información de la Cuenta"})}),e.jsxs(j,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Fecha de creación:"}),e.jsx("span",{className:"font-medium",children:new Date(a.created_at).toLocaleDateString("es-AR",{year:"numeric",month:"long",day:"numeric"})})]}),a.last_login&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Último acceso:"}),e.jsx("span",{className:"font-medium",children:new Date(a.last_login).toLocaleDateString("es-AR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})]})}):e.jsx(f,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-red-500",children:"Error al cargar el perfil"})})})}export{H as default};
//# sourceMappingURL=ProfilePage-DK2LhmZM.js.map
