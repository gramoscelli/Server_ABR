{"version":3,"file":"PasswordStrengthIndicator-zkYWuGO2.js","sources":["../../src/components/PasswordStrengthIndicator.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { CheckCircle2, XCircle, AlertCircle } from 'lucide-react';\n\ninterface PasswordRequirement {\n  name: string;\n  label: string;\n  met: boolean;\n  required: boolean;\n  current?: number;\n  expected?: number;\n  examples?: string;\n}\n\ninterface PasswordValidation {\n  valid: boolean;\n  score: number;\n  strength: 'weak' | 'fair' | 'good' | 'strong' | 'excellent';\n  message: string;\n  requirements: PasswordRequirement[];\n  feedback: string[];\n}\n\ninterface PasswordStrengthIndicatorProps {\n  password: string;\n  onValidationChange?: (validation: PasswordValidation | null) => void;\n}\n\nexport function PasswordStrengthIndicator({ password, onValidationChange }: PasswordStrengthIndicatorProps) {\n  const [validation, setValidation] = useState<PasswordValidation | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [csrfToken, setCsrfToken] = useState('');\n\n  // Get CSRF token on mount\n  useEffect(() => {\n    fetch('/api/csrf-token', { credentials: 'include' })\n      .then(res => res.json())\n      .then(data => setCsrfToken(data.csrfToken))\n      .catch(err => console.error('Failed to get CSRF token:', err));\n  }, []);\n\n  // Validate password when it changes\n  useEffect(() => {\n    // Clear validation immediately if password is empty\n    if (!password || password.length === 0) {\n      setValidation(null);\n      onValidationChange?.(null);\n      setLoading(false);\n      return;\n    }\n\n    if (!csrfToken) return;\n\n    const timeoutId = setTimeout(async () => {\n      setLoading(true);\n      try {\n        const response = await fetch('/api/auth/validate-password', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'X-CSRF-Token': csrfToken,\n          },\n          credentials: 'include',\n          body: JSON.stringify({ password }),\n        });\n\n        if (response.ok) {\n          const data = await response.json();\n          setValidation(data);\n          onValidationChange?.(data);\n        }\n      } catch (error) {\n        console.error('Password validation error:', error);\n      } finally {\n        setLoading(false);\n      }\n    }, 300); // Debounce 300ms\n\n    return () => clearTimeout(timeoutId);\n  }, [password, csrfToken, onValidationChange]);\n\n  // Don't show anything if password is empty or validation hasn't been received yet\n  if (!password || password.length === 0 || !validation) {\n    return null;\n  }\n\n  const getStrengthColor = () => {\n    switch (validation.strength) {\n      case 'excellent': return 'bg-green-500';\n      case 'strong': return 'bg-blue-500';\n      case 'good': return 'bg-yellow-500';\n      case 'fair': return 'bg-orange-500';\n      case 'weak': return 'bg-red-500';\n      default: return 'bg-gray-500';\n    }\n  };\n\n  const getStrengthTextColor = () => {\n    switch (validation.strength) {\n      case 'excellent': return 'text-green-700';\n      case 'strong': return 'text-blue-700';\n      case 'good': return 'text-yellow-700';\n      case 'fair': return 'text-orange-700';\n      case 'weak': return 'text-red-700';\n      default: return 'text-gray-700';\n    }\n  };\n\n  const getStrengthText = () => {\n    switch (validation.strength) {\n      case 'excellent': return 'Excelente';\n      case 'strong': return 'Fuerte';\n      case 'good': return 'Buena';\n      case 'fair': return 'Regular';\n      case 'weak': return 'Débil';\n      default: return '';\n    }\n  };\n\n  return (\n    <div className=\"mt-3 space-y-3\">\n      {/* Strength Bar */}\n      <div className=\"space-y-1\">\n        <div className=\"flex justify-between items-center text-xs\">\n          <span className={`font-medium ${getStrengthTextColor()}`}>\n            Fortaleza: {getStrengthText()}\n          </span>\n          <span className=\"text-gray-500\">\n            {validation.score}/100\n          </span>\n        </div>\n        <div className=\"w-full bg-gray-200 rounded-full h-2 overflow-hidden\">\n          <div\n            className={`h-2 rounded-full transition-all duration-300 ${getStrengthColor()}`}\n            style={{ width: `${validation.score}%` }}\n          />\n        </div>\n      </div>\n\n      {/* Requirements List */}\n      <div className=\"space-y-1.5\">\n        <p className=\"text-xs font-medium text-gray-700\">Requisitos:</p>\n        <div className=\"space-y-1\">\n          {validation.requirements\n            .filter(req => req.required)\n            .map((req) => (\n              !req.met ? \n              <div key={req.name} className=\"flex items-start gap-2 text-xs\">\n                  <XCircle className=\"h-4 w-4 text-red-500 flex-shrink-0 mt-0.5\" />\n                <span className={req.met ? 'text-gray-600' : 'text-gray-900'}>\n                  {req.label}\n                  {req.current !== undefined && req.expected !== undefined && !req.met && (\n                    <span className=\"text-gray-500 ml-1\">\n                      ({req.current}/{req.expected})\n                    </span>\n                  )}\n                </span>\n              </div> :  <></>)\n            )}\n        </div>\n      </div>\n\n      {/* Feedback */}\n      {validation.feedback && validation.feedback.length > 0 && (\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-md p-3\">\n          <div className=\"flex items-start gap-2\">\n            <AlertCircle className=\"h-4 w-4 text-yellow-600 flex-shrink-0 mt-0.5\" />\n            <div className=\"flex-1\">\n              <p className=\"text-xs font-medium text-yellow-800 mb-1\">Sugerencias:</p>\n              <ul className=\"text-xs text-yellow-700 space-y-0.5\">\n                {validation.feedback.map((tip, index) => (\n                  <li key={index}>• {tip}</li>\n                ))}\n              </ul>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Success Message */}\n      {validation.valid && (\n        <div className=\"bg-green-50 border border-green-200 rounded-md p-3\">\n          <div className=\"flex items-center gap-2\">\n            <CheckCircle2 className=\"h-4 w-4 text-green-600\" />\n            <p className=\"text-xs text-green-800\">\n              ✓ La contraseña cumple con todos los requisitos de seguridad\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* Special Characters Examples */}\n      {validation.requirements.find(r => r.name === 'specialChars' && !r.met) && (\n        <div className=\"text-xs text-gray-500\">\n          <span className=\"font-medium\">Caracteres especiales permitidos:</span>\n          {' '}!@#$%^&*()_+-=[]{};\\':\"|,&lt;&gt;/?~`\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["PasswordStrengthIndicator","password","onValidationChange","validation","setValidation","useState","loading","setLoading","csrfToken","setCsrfToken","useEffect","res","data","err","timeoutId","response","error","getStrengthColor","getStrengthTextColor","getStrengthText","jsxs","jsx","req","Fragment","XCircle","AlertCircle","tip","index","CheckCircle2","r"],"mappings":"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"}