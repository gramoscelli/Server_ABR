{"version":3,"file":"ProfilePage-D8Wr4eaD.js","sources":["../../node_modules/lucide-react/dist/esm/icons/phone.js","../../src/pages/ProfilePage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384\",\n      key: \"9njp5v\"\n    }\n  ]\n];\nconst Phone = createLucideIcon(\"phone\", __iconNode);\n\nexport { __iconNode, Phone as default };\n//# sourceMappingURL=phone.js.map\n","import { useState, useEffect } from 'react'\nimport { AdminLayout } from '@/components/AdminLayout'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { useToast } from '@/components/ui/use-toast'\nimport { User, Mail, Phone, AlertCircle, CheckCircle2 } from 'lucide-react'\nimport { fetchWithAuth } from '@/lib/auth'\n\ninterface UserProfile {\n  id: number\n  username: string\n  email: string | null\n  nombre: string | null\n  apellido: string | null\n  whatsapp: string | null\n  role: string\n  oauth_only: boolean\n  avatar_url: string | null\n  created_at: string\n  last_login: string | null\n}\n\nexport default function ProfilePage() {\n  const [loading, setLoading] = useState(true)\n  const [saving, setSaving] = useState(false)\n  const [profile, setProfile] = useState<UserProfile | null>(null)\n  const [formData, setFormData] = useState({\n    nombre: '',\n    apellido: '',\n    email: '',\n    whatsapp: ''\n  })\n  const { toast } = useToast()\n\n  // Load user profile\n  useEffect(() => {\n    loadProfile()\n  }, [])\n\n  const loadProfile = async () => {\n    try {\n      const response = await fetchWithAuth('/api/auth/me')\n      if (response.ok) {\n        const data = await response.json()\n        setProfile(data.user)\n        setFormData({\n          nombre: data.user.nombre || '',\n          apellido: data.user.apellido || '',\n          email: data.user.email || '',\n          whatsapp: data.user.whatsapp || ''\n        })\n      } else {\n        throw new Error('Failed to load profile')\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'No se pudo cargar el perfil'\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setSaving(true)\n\n    try {\n      // Get CSRF token\n      const csrfRes = await fetch('/api/csrf-token', {\n        credentials: 'include'\n      })\n      const { csrfToken } = await csrfRes.json()\n\n      // Update profile\n      const response = await fetchWithAuth('/api/auth/profile', {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRF-Token': csrfToken\n        },\n        body: JSON.stringify(formData)\n      })\n\n      if (response.ok) {\n        const data = await response.json()\n        setProfile(data.user)\n        toast({\n          title: 'Éxito',\n          description: 'Perfil actualizado correctamente'\n        })\n      } else {\n        const error = await response.json()\n        throw new Error(error.message || 'Error al actualizar el perfil')\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: error instanceof Error ? error.message : 'Error al actualizar el perfil'\n      })\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const handleReset = () => {\n    if (profile) {\n      setFormData({\n        nombre: profile.nombre || '',\n        apellido: profile.apellido || '',\n        email: profile.email || '',\n        whatsapp: profile.whatsapp || ''\n      })\n    }\n  }\n\n  if (loading) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <div className=\"text-gray-500\">Cargando perfil...</div>\n        </div>\n      </AdminLayout>\n    )\n  }\n\n  if (!profile) {\n    return (\n      <AdminLayout>\n        <div className=\"flex items-center justify-center h-64\">\n          <div className=\"text-red-500\">Error al cargar el perfil</div>\n        </div>\n      </AdminLayout>\n    )\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6 max-w-3xl\">\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Mi Perfil</h1>\n          <p className=\"mt-2 text-gray-600\">\n            Administra tu información personal y configuración de cuenta\n          </p>\n        </div>\n\n        {/* Account Info Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <User className=\"h-5 w-5\" />\n              Información de la Cuenta\n            </CardTitle>\n            <CardDescription>\n              Tu nombre de usuario es único y no puede ser modificado\n            </CardDescription>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {/* Username (read-only) */}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"username\">Nombre de Usuario</Label>\n              <Input\n                id=\"username\"\n                value={profile.username}\n                disabled\n                className=\"bg-gray-100 cursor-not-allowed\"\n              />\n              <p className=\"text-xs text-gray-500\">\n                El nombre de usuario no puede ser modificado\n              </p>\n            </div>\n\n            {/* Role (read-only) */}\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"role\">Rol</Label>\n              <Input\n                id=\"role\"\n                value={profile.role}\n                disabled\n                className=\"bg-gray-100 cursor-not-allowed\"\n              />\n            </div>\n\n            {/* Security Notice */}\n            <div className=\"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n              <CheckCircle2 className=\"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5\" />\n              <div>\n                <h4 className=\"font-semibold text-blue-900\">\n                  {profile.oauth_only ? 'Cuenta OAuth' : 'Información de Seguridad'}\n                </h4>\n                <p className=\"text-sm text-blue-800 mt-1\">\n                  {profile.oauth_only\n                    ? 'Esta cuenta usa autenticación OAuth. El email está vinculado a tu proveedor OAuth y no puede ser modificado.'\n                    : 'Por seguridad, el email asociado a tu cuenta no puede ser modificado. Si necesitas cambiar tu email, contacta a un administrador.'}\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Profile Information Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Mail className=\"h-5 w-5\" />\n              Información Personal\n            </CardTitle>\n            <CardDescription>\n              Actualiza tus datos personales de contacto\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\n              {/* First Name */}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"nombre\">Nombre</Label>\n                <Input\n                  id=\"nombre\"\n                  value={formData.nombre}\n                  onChange={(e) => setFormData({ ...formData, nombre: e.target.value })}\n                  placeholder=\"Tu nombre\"\n                />\n              </div>\n\n              {/* Last Name */}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"apellido\">Apellido</Label>\n                <Input\n                  id=\"apellido\"\n                  value={formData.apellido}\n                  onChange={(e) => setFormData({ ...formData, apellido: e.target.value })}\n                  placeholder=\"Tu apellido\"\n                />\n              </div>\n\n              {/* Email - Always disabled */}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"email\">Email</Label>\n                <Input\n                  id=\"email\"\n                  type=\"email\"\n                  value={formData.email}\n                  disabled\n                  className=\"bg-gray-100 cursor-not-allowed\"\n                />\n                <p className=\"text-xs text-gray-500\">\n                  El email no puede ser modificado por seguridad. Contacta a un administrador si necesitas cambiarlo.\n                </p>\n              </div>\n\n              {/* WhatsApp */}\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"whatsapp\" className=\"flex items-center gap-2\">\n                  <Phone className=\"h-4 w-4\" />\n                  WhatsApp\n                </Label>\n                <Input\n                  id=\"whatsapp\"\n                  type=\"tel\"\n                  value={formData.whatsapp}\n                  onChange={(e) => setFormData({ ...formData, whatsapp: e.target.value })}\n                  placeholder=\"+1234567890\"\n                />\n                <p className=\"text-xs text-gray-500\">\n                  Formato internacional (ej: +549261234567)\n                </p>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"flex gap-3 pt-4\">\n                <Button\n                  type=\"submit\"\n                  disabled={saving}\n                  className=\"flex-1\"\n                >\n                  {saving ? 'Guardando...' : 'Guardar Cambios'}\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={handleReset}\n                  disabled={saving}\n                >\n                  Restablecer\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n\n        {/* Account Metadata */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Información de la Cuenta</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <div className=\"flex justify-between text-sm\">\n              <span className=\"text-gray-600\">Fecha de creación:</span>\n              <span className=\"font-medium\">\n                {new Date(profile.created_at).toLocaleDateString('es-AR', {\n                  year: 'numeric',\n                  month: 'long',\n                  day: 'numeric'\n                })}\n              </span>\n            </div>\n            {profile.last_login && (\n              <div className=\"flex justify-between text-sm\">\n                <span className=\"text-gray-600\">Último acceso:</span>\n                <span className=\"font-medium\">\n                  {new Date(profile.last_login).toLocaleDateString('es-AR', {\n                    year: 'numeric',\n                    month: 'long',\n                    day: 'numeric',\n                    hour: '2-digit',\n                    minute: '2-digit'\n                  })}\n                </span>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  )\n}\n"],"names":["__iconNode","Phone","createLucideIcon","ProfilePage","loading","setLoading","useState","saving","setSaving","profile","setProfile","formData","setFormData","toast","useToast","useEffect","loadProfile","response","fetchWithAuth","data","handleSubmit","e","csrfRes","csrfToken","error","handleReset","jsx","AdminLayout","jsxs","Card","CardHeader","CardTitle","User","CardDescription","CardContent","Label","Input","CheckCircle2","Mail","Button"],"mappings":"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","x_google_ignoreList":[0]}