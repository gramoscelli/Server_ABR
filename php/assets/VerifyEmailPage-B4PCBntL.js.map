{"version":3,"file":"VerifyEmailPage-B4PCBntL.js","sources":["../../src/pages/VerifyEmailPage.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { useSearchParams, Link, useNavigate } from 'react-router-dom';\nimport { CheckCircle2, XCircle, Loader2 } from 'lucide-react';\n\nexport default function VerifyEmailPage() {\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const [status, setStatus] = useState<'loading' | 'success' | 'error' | 'already-verified'>('loading');\n  const [message, setMessage] = useState('');\n  const token = searchParams.get('token');\n\n  useEffect(() => {\n    if (!token) {\n      setStatus('error');\n      setMessage('Token de verificación no encontrado');\n      return;\n    }\n\n    verifyEmail(token);\n  }, [token]);\n\n  const verifyEmail = async (token: string) => {\n    try {\n      const csrfResponse = await fetch('/api/csrf-token', {\n        credentials: 'include'\n      });\n      const { csrfToken } = await csrfResponse.json();\n\n      const response = await fetch('/api/auth/verify-email', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRF-Token': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({ token }),\n      });\n\n      const data = await response.json();\n\n      if (response.ok) {\n        if (data.alreadyVerified) {\n          setStatus('already-verified');\n          setMessage('Este email ya ha sido verificado anteriormente');\n        } else {\n          setStatus('success');\n          setMessage(data.message || 'Email verificado exitosamente');\n        }\n\n        // Redirect to login after 3 seconds\n        setTimeout(() => {\n          navigate('/login');\n        }, 3000);\n      } else {\n        setStatus('error');\n        setMessage(data.message || 'Error al verificar el email');\n      }\n    } catch (err) {\n      setStatus('error');\n      setMessage('Error de conexión al verificar el email');\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\n      <div className=\"max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow-md\">\n        <div className=\"text-center\">\n          {status === 'loading' && (\n            <>\n              <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 mb-4\">\n                <Loader2 className=\"h-6 w-6 text-blue-600 animate-spin\" />\n              </div>\n              <h2 className=\"text-2xl font-bold text-gray-900\">\n                Verificando Email\n              </h2>\n              <p className=\"mt-4 text-gray-600\">\n                Por favor espera mientras verificamos tu dirección de email...\n              </p>\n            </>\n          )}\n\n          {status === 'success' && (\n            <>\n              <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4\">\n                <CheckCircle2 className=\"h-6 w-6 text-green-600\" />\n              </div>\n              <h2 className=\"text-2xl font-bold text-gray-900\">\n                ¡Email Verificado!\n              </h2>\n              <p className=\"mt-4 text-gray-600\">\n                {message}\n              </p>\n              <p className=\"mt-2 text-sm text-gray-500\">\n                Serás redirigido al login en 3 segundos...\n              </p>\n            </>\n          )}\n\n          {status === 'already-verified' && (\n            <>\n              <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 mb-4\">\n                <CheckCircle2 className=\"h-6 w-6 text-blue-600\" />\n              </div>\n              <h2 className=\"text-2xl font-bold text-gray-900\">\n                Email Ya Verificado\n              </h2>\n              <p className=\"mt-4 text-gray-600\">\n                {message}\n              </p>\n              <p className=\"mt-2 text-sm text-gray-500\">\n                Serás redirigido al login en 3 segundos...\n              </p>\n            </>\n          )}\n\n          {status === 'error' && (\n            <>\n              <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4\">\n                <XCircle className=\"h-6 w-6 text-red-600\" />\n              </div>\n              <h2 className=\"text-2xl font-bold text-gray-900\">\n                Error de Verificación\n              </h2>\n              <p className=\"mt-4 text-gray-600\">\n                {message}\n              </p>\n            </>\n          )}\n        </div>\n\n        {status === 'error' && (\n          <div className=\"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\n            <h4 className=\"text-sm font-semibold text-yellow-900 mb-2\">\n              ¿Qué puedes hacer?\n            </h4>\n            <ul className=\"text-xs text-yellow-800 space-y-1 list-disc list-inside\">\n              <li>Verifica que el enlace no esté incompleto</li>\n              <li>El token puede haber expirado (válido por 24 horas)</li>\n              <li>Solicita un nuevo email de verificación</li>\n            </ul>\n          </div>\n        )}\n\n        <div className=\"text-center space-y-3 mt-6\">\n          <Link\n            to=\"/login\"\n            className=\"inline-block w-full py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n          >\n            Ir al Login\n          </Link>\n          {status === 'error' && (\n            <Link\n              to=\"/resend-verification\"\n              className=\"inline-block w-full py-2 px-4 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n            >\n              Reenviar Email de Verificación\n            </Link>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["VerifyEmailPage","searchParams","useSearchParams","navigate","useNavigate","status","setStatus","useState","message","setMessage","token","useEffect","verifyEmail","csrfResponse","csrfToken","response","data","jsxs","Fragment","jsx","Loader2","CheckCircle2","XCircle","Link"],"mappings":"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"}