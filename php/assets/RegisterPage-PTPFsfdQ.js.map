{"version":3,"file":"RegisterPage-PTPFsfdQ.js","sources":["../../src/components/UsernameValidator.tsx","../../src/components/Captcha.tsx","../../src/pages/RegisterPage.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { CheckCircle2, XCircle, Loader2 } from 'lucide-react';\n\ninterface UsernameRequirement {\n  name: string;\n  label: string;\n  met: boolean;\n  required: boolean;\n  current?: number;\n  expected?: number;\n}\n\ninterface UsernameValidation {\n  valid: boolean;\n  available: boolean | null;\n  availabilityMessage: string;\n  requirements: UsernameRequirement[];\n  message: string;\n  feedback: string[];\n}\n\ninterface UsernameValidatorProps {\n  username: string;\n  onValidationChange?: (validation: UsernameValidation | null) => void;\n}\n\nexport function UsernameValidator({ username, onValidationChange }: UsernameValidatorProps) {\n  const [validation, setValidation] = useState<UsernameValidation | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [csrfToken, setCsrfToken] = useState('');\n\n  // Get CSRF token on mount\n  useEffect(() => {\n    fetch('/api/csrf-token', { credentials: 'include' })\n      .then(res => res.json())\n      .then(data => setCsrfToken(data.csrfToken))\n      .catch(err => console.error('Failed to get CSRF token:', err));\n  }, []);\n\n  // Validate username when it changes\n  useEffect(() => {\n    // Clear validation immediately if username is empty\n    if (!username || username.length === 0) {\n      setValidation(null);\n      onValidationChange?.(null);\n      setLoading(false);\n      return;\n    }\n\n    if (!csrfToken) return;\n\n    const timeoutId = setTimeout(async () => {\n      setLoading(true);\n      try {\n        const response = await fetch('/api/auth/validate-username', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'X-CSRF-Token': csrfToken,\n          },\n          credentials: 'include',\n          body: JSON.stringify({ username }),\n        });\n\n        if (response.ok) {\n          const data = await response.json();\n          setValidation(data);\n          onValidationChange?.(data);\n        }\n      } catch (error) {\n        console.error('Username validation error:', error);\n      } finally {\n        setLoading(false);\n      }\n    }, 300); // Debounce 300ms\n\n    return () => clearTimeout(timeoutId);\n  }, [username, csrfToken, onValidationChange]);\n\n  // Don't show anything if username is empty or validation hasn't been received yet\n  if (!username || username.length === 0) {\n    return null;\n  }\n\n  // Show loading state\n  if (loading) {\n    return (\n      <div className=\"mt-2 flex items-center gap-2 text-sm text-gray-500\">\n        <Loader2 className=\"h-4 w-4 animate-spin\" />\n        <span>Validando nombre de usuario...</span>\n      </div>\n    );\n  }\n\n  if (!validation) {\n    return null;\n  }\n\n  return (\n    <div className=\"mt-3 space-y-3\">\n      {/* Requirements List - Only show unmet requirements */}\n      <div className=\"space-y-1.5\">\n        <p className=\"text-xs font-medium text-gray-700\">Requisitos:</p>\n        <div className=\"space-y-1\">\n          {validation.requirements\n            .filter(req => req.required)\n            .map((req) => (\n              !req.met ? (\n                <div key={req.name} className=\"flex items-start gap-2 text-xs\">\n                  <XCircle className=\"h-4 w-4 text-red-500 flex-shrink-0 mt-0.5\" />\n                  <span className=\"text-gray-900\">\n                    {req.label}\n                    {req.current !== undefined && req.expected !== undefined && !req.met && (\n                      <span className=\"text-gray-500 ml-1\">\n                        ({req.current}/{req.expected})\n                      </span>\n                    )}\n                  </span>\n                </div>\n              ) : <div key={req.name}></div>\n            ))}\n        </div>\n      </div>\n\n      {/* Availability Check - Only show if format is valid */}\n      {validation.valid && validation.available !== null && (\n        <div className=\"mt-2\">\n          {validation.available ? (\n            <div className=\"flex items-center gap-2 text-sm text-green-600\">\n              <CheckCircle2 className=\"h-4 w-4\" />\n              <span>{validation.availabilityMessage}</span>\n            </div>\n          ) : (\n            <div className=\"flex items-center gap-2 text-sm text-red-600\">\n              <XCircle className=\"h-4 w-4\" />\n              <span>{validation.availabilityMessage}</span>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Success Message */}\n      {validation.valid && validation.available && (\n        <div className=\"bg-green-50 border border-green-200 rounded-md p-3\">\n          <div className=\"flex items-center gap-2\">\n            <CheckCircle2 className=\"h-4 w-4 text-green-600\" />\n            <p className=\"text-xs text-green-800\">\n              ✓ El nombre de usuario es válido y está disponible\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* Feedback */}\n      {validation.feedback && validation.feedback.length > 0 && (\n        <div className=\"space-y-0.5\">\n          {validation.feedback.map((tip, index) => (\n            <p key={index} className=\"text-xs text-gray-600\">• {tip}</p>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","import { useState, useEffect } from 'react';\nimport { RefreshCw, AlertCircle } from 'lucide-react';\n\ninterface CaptchaProps {\n  onCaptchaChange: (tokenId: string | null, response: string) => void;\n  error?: string;\n}\n\ninterface CaptchaData {\n  tokenId: string;\n  svg: string;\n  expiresAt: string;\n  type: string;\n}\n\nexport function Captcha({ onCaptchaChange, error }: CaptchaProps) {\n  const [captchaData, setCaptchaData] = useState<CaptchaData | null>(null);\n  const [captchaResponse, setCaptchaResponse] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [loadError, setLoadError] = useState('');\n\n  const loadCaptcha = async () => {\n    setLoading(true);\n    setLoadError('');\n    setCaptchaResponse('');\n\n    try {\n      const response = await fetch('/api/captcha/generate', {\n        credentials: 'include'\n      });\n\n      if (!response.ok) {\n        throw new Error('Error al cargar CAPTCHA');\n      }\n\n      const data: CaptchaData = await response.json();\n      setCaptchaData(data);\n      onCaptchaChange(data.tokenId, '');\n    } catch (err) {\n      setLoadError(err instanceof Error ? err.message : 'Error al cargar CAPTCHA');\n      setCaptchaData(null);\n      onCaptchaChange(null, '');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadCaptcha();\n  }, []);\n\n  const handleResponseChange = (value: string) => {\n    setCaptchaResponse(value);\n    if (captchaData) {\n      onCaptchaChange(captchaData.tokenId, value);\n    }\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      <label className=\"block text-sm font-medium text-gray-700\">\n        Verificación CAPTCHA\n      </label>\n\n      {/* CAPTCHA Image */}\n      <div className=\"relative border border-gray-300 rounded-lg p-4 bg-gray-50\">\n        {loading && (\n          <div className=\"flex items-center justify-center h-24\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600\"></div>\n          </div>\n        )}\n\n        {loadError && (\n          <div className=\"flex items-center justify-center h-24 text-red-600\">\n            <div className=\"text-center\">\n              <AlertCircle className=\"h-8 w-8 mx-auto mb-2\" />\n              <p className=\"text-sm\">{loadError}</p>\n            </div>\n          </div>\n        )}\n\n        {!loading && !loadError && captchaData && (\n          <div\n            className=\"captcha-svg-container flex items-center justify-center\"\n            dangerouslySetInnerHTML={{ __html: captchaData.svg }}\n          />\n        )}\n\n        {/* Reload Button */}\n        <button\n          type=\"button\"\n          onClick={loadCaptcha}\n          disabled={loading}\n          className=\"absolute top-2 right-2 p-2 text-gray-500 hover:text-indigo-600 hover:bg-white rounded-md transition-colors disabled:opacity-50\"\n          title=\"Recargar CAPTCHA\"\n        >\n          <RefreshCw className={`h-4 w-4 ${loading ? 'animate-spin' : ''}`} />\n        </button>\n      </div>\n\n      {/* CAPTCHA Input */}\n      <div>\n        <input\n          type=\"text\"\n          placeholder=\"Ingresa el código que ves arriba\"\n          value={captchaResponse}\n          onChange={(e) => handleResponseChange(e.target.value)}\n          className={`appearance-none relative block w-full px-3 py-2 border ${\n            error ? 'border-red-300' : 'border-gray-300'\n          } placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm`}\n          required\n          autoComplete=\"off\"\n        />\n\n        {error && (\n          <p className=\"mt-1 text-sm text-red-600 flex items-center gap-1\">\n            <AlertCircle className=\"h-4 w-4\" />\n            {error}\n          </p>\n        )}\n\n        <p className=\"mt-1 text-xs text-gray-500\">\n          El CAPTCHA expira en 5 minutos. No distingue entre mayúsculas y minúsculas.\n        </p>\n      </div>\n    </div>\n  );\n}\n","import { useState } from 'react';\nimport { useNavigate, Link } from 'react-router-dom';\nimport { Eye, EyeOff, CheckCircle2, XCircle } from 'lucide-react';\nimport { PasswordStrengthIndicator } from '@/components/PasswordStrengthIndicator';\nimport { UsernameValidator } from '@/components/UsernameValidator';\nimport { Captcha } from '@/components/Captcha';\n\nexport default function RegisterPage() {\n  const [formData, setFormData] = useState({\n    username: '',\n    email: '',\n    password: '',\n    confirmPassword: ''\n  });\n  const [error, setError] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [success, setSuccess] = useState(false);\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [passwordValidation, setPasswordValidation] = useState<any>(null);\n  const [usernameValidation, setUsernameValidation] = useState<any>(null);\n  const [captchaToken, setCaptchaToken] = useState<string | null>(null);\n  const [captchaResponse, setCaptchaResponse] = useState('');\n  const [captchaError, setCaptchaError] = useState('');\n  const navigate = useNavigate();\n\n  const handleCaptchaChange = (tokenId: string | null, response: string) => {\n    setCaptchaToken(tokenId);\n    setCaptchaResponse(response);\n    setCaptchaError('');\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n    setCaptchaError('');\n    setLoading(true);\n\n    // Validate username\n    if (!usernameValidation || !usernameValidation.valid) {\n      setError('El nombre de usuario no cumple con los requisitos');\n      setLoading(false);\n      return;\n    }\n\n    // Validate username availability\n    if (!usernameValidation.available) {\n      setError('El nombre de usuario ya está en uso');\n      setLoading(false);\n      return;\n    }\n\n    // Validate passwords match\n    if (formData.password !== formData.confirmPassword) {\n      setError('Las contraseñas no coinciden');\n      setLoading(false);\n      return;\n    }\n\n    // Validate password strength\n    if (!passwordValidation || !passwordValidation.valid) {\n      setError('La contraseña no cumple con los requisitos de seguridad');\n      setLoading(false);\n      return;\n    }\n\n    // Validate email format\n    if (!formData.email.includes('@')) {\n      setError('Por favor ingresa un email válido');\n      setLoading(false);\n      return;\n    }\n\n    // Validate CAPTCHA\n    if (!captchaToken || !captchaResponse) {\n      setCaptchaError('Por favor completa el CAPTCHA');\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const csrfResponse = await fetch('/api/csrf-token', {\n        credentials: 'include'\n      });\n      const { csrfToken } = await csrfResponse.json();\n\n      const response = await fetch('/api/auth/register', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRF-Token': csrfToken,\n        },\n        credentials: 'include',\n        body: JSON.stringify({\n          username: formData.username,\n          email: formData.email,\n          password: formData.password,\n          captchaToken: captchaToken,\n          captchaResponse: captchaResponse\n        }),\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        // Handle CAPTCHA errors specifically\n        if (data.captchaRequired || data.error === 'CAPTCHA inválido' || data.error === 'CAPTCHA requerido') {\n          setCaptchaError(data.message || 'CAPTCHA incorrecto');\n          setLoading(false);\n          return;\n        }\n\n        // Handle rate limiting with retry time\n        if (data.retryAfter) {\n          throw new Error(`${data.message || data.error} Por favor intenta nuevamente en: ${data.retryAfter}.`);\n        }\n\n        throw new Error(data.message || 'Error al registrarse');\n      }\n\n      // Success - show message\n      setSuccess(true);\n\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Error al registrarse');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (success) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\n        <div className=\"max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow-md\">\n          <div className=\"text-center\">\n            <div className=\"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4\">\n              <CheckCircle2 className=\"h-6 w-6 text-green-600\" />\n            </div>\n            <h2 className=\"text-2xl font-bold text-gray-900\">\n              ¡Registro Exitoso!\n            </h2>\n            <p className=\"mt-4 text-gray-600\">\n              Tu cuenta ha sido creada exitosamente.\n            </p>\n            <p className=\"mt-2 text-sm text-gray-500\">\n              Te hemos enviado un email de verificación a <strong>{formData.email}</strong>.\n              Por favor, revisa tu bandeja de entrada y haz clic en el enlace de verificación para activar tu cuenta.\n            </p>\n          </div>\n\n          <div className=\"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n            <h4 className=\"text-sm font-semibold text-blue-900 mb-2\">\n              Próximos pasos:\n            </h4>\n            <ol className=\"text-xs text-blue-800 space-y-1 list-decimal list-inside\">\n              <li>Revisa tu email ({formData.email})</li>\n              <li>Haz clic en el enlace de verificación</li>\n              <li>Una vez verificado, podrás iniciar sesión</li>\n            </ol>\n          </div>\n\n          <div className=\"text-center space-y-3\">\n            <Link\n              to=\"/login\"\n              className=\"inline-block w-full py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n            >\n              Ir al Login\n            </Link>\n            <p className=\"text-xs text-gray-500\">\n              ¿No recibiste el email?{' '}\n              <Link to=\"/resend-verification\" className=\"text-indigo-600 hover:text-indigo-500\">\n                Reenviar email de verificación\n              </Link>\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\n      <div className=\"max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow-md\">\n        <div>\n          <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\n            Crear Cuenta\n          </h2>\n          <p className=\"mt-2 text-center text-sm text-gray-600\">\n            Regístrate para acceder al sistema\n          </p>\n        </div>\n        <form className=\"mt-8 space-y-6\" onSubmit={handleSubmit}>\n          {error && (\n            <div className=\"rounded-md bg-red-50 p-4\">\n              <p className=\"text-sm text-red-800\">{error}</p>\n            </div>\n          )}\n\n          <div className=\"space-y-4\">\n            {/* Username */}\n            <div>\n              <label htmlFor=\"username\" className=\"block text-sm font-medium text-gray-700\">\n                Nombre de Usuario\n              </label>\n              <input\n                id=\"username\"\n                name=\"username\"\n                type=\"text\"\n                required\n                className=\"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                placeholder=\"usuario123\"\n                value={formData.username}\n                onChange={(e) => setFormData({ ...formData, username: e.target.value })}\n                minLength={3}\n              />\n\n              {/* Username Validator */}\n              <UsernameValidator\n                username={formData.username}\n                onValidationChange={setUsernameValidation}\n              />\n            </div>\n\n            {/* Email */}\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\n                Email\n              </label>\n              <input\n                id=\"email\"\n                name=\"email\"\n                type=\"email\"\n                required\n                className=\"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                placeholder=\"tu@email.com\"\n                value={formData.email}\n                onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n              />\n              <p className=\"mt-1 text-xs text-gray-500\">\n                Te enviaremos un email de verificación\n              </p>\n            </div>\n\n            {/* Password */}\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">\n                Contraseña\n              </label>\n              <div className=\"mt-1 relative\">\n                <input\n                  id=\"password\"\n                  name=\"password\"\n                  type={showPassword ? 'text' : 'password'}\n                  required\n                  className=\"appearance-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                  placeholder=\"••••••••\"\n                  value={formData.password}\n                  onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                  minLength={6}\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                >\n                  {showPassword ? (\n                    <EyeOff className=\"h-4 w-4\" />\n                  ) : (\n                    <Eye className=\"h-4 w-4\" />\n                  )}\n                </button>\n              </div>\n\n              {/* Password Strength Indicator */}\n              <PasswordStrengthIndicator\n                password={formData.password}\n                onValidationChange={setPasswordValidation}\n              />\n            </div>\n\n            {/* Confirm Password */}\n            <div>\n              <label htmlFor=\"confirmPassword\" className=\"block text-sm font-medium text-gray-700\">\n                Confirmar Contraseña\n              </label>\n              <div className=\"mt-1 relative\">\n                <input\n                  id=\"confirmPassword\"\n                  name=\"confirmPassword\"\n                  type={showConfirmPassword ? 'text' : 'password'}\n                  required\n                  className=\"appearance-none relative block w-full px-3 py-2 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n                  placeholder=\"••••••••\"\n                  value={formData.confirmPassword}\n                  onChange={(e) => setFormData({ ...formData, confirmPassword: e.target.value })}\n                  minLength={6}\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                >\n                  {showConfirmPassword ? (\n                    <EyeOff className=\"h-4 w-4\" />\n                  ) : (\n                    <Eye className=\"h-4 w-4\" />\n                  )}\n                </button>\n              </div>\n\n              {/* Password Match Indicator */}\n              {formData.confirmPassword && (\n                <div className=\"mt-2\">\n                  {formData.password === formData.confirmPassword ? (\n                    <div className=\"flex items-center gap-2 text-sm text-green-600\">\n                      <CheckCircle2 className=\"h-4 w-4\" />\n                      <span>Las contraseñas coinciden</span>\n                    </div>\n                  ) : (\n                    <div className=\"flex items-center gap-2 text-sm text-red-600\">\n                      <XCircle className=\"h-4 w-4\" />\n                      <span>Las contraseñas no coinciden</span>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n\n            {/* CAPTCHA */}\n            <Captcha\n              onCaptchaChange={handleCaptchaChange}\n              error={captchaError}\n            />\n          </div>\n\n          <div>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50\"\n            >\n              {loading ? 'Creando cuenta...' : 'Registrarse'}\n            </button>\n          </div>\n\n          <div className=\"text-center\">\n            <p className=\"text-sm text-gray-600\">\n              ¿Ya tienes una cuenta?{' '}\n              <Link to=\"/login\" className=\"font-medium text-indigo-600 hover:text-indigo-500\">\n                Inicia sesión\n              </Link>\n            </p>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":["UsernameValidator","username","onValidationChange","validation","setValidation","useState","loading","setLoading","csrfToken","setCsrfToken","useEffect","res","data","err","timeoutId","response","error","jsxs","jsx","Loader2","req","XCircle","CheckCircle2","tip","index","Captcha","onCaptchaChange","captchaData","setCaptchaData","captchaResponse","setCaptchaResponse","loadError","setLoadError","loadCaptcha","handleResponseChange","value","AlertCircle","RefreshCw","e","RegisterPage","formData","setFormData","setError","success","setSuccess","showPassword","setShowPassword","showConfirmPassword","setShowConfirmPassword","passwordValidation","setPasswordValidation","usernameValidation","setUsernameValidation","captchaToken","setCaptchaToken","captchaError","setCaptchaError","useNavigate","handleCaptchaChange","tokenId","handleSubmit","csrfResponse","Link","EyeOff","Eye","PasswordStrengthIndicator"],"mappings":"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"}