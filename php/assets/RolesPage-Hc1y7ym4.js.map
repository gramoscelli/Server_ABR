{"version":3,"file":"RolesPage-Hc1y7ym4.js","sources":["../../src/pages/admin/RolesPage.tsx"],"sourcesContent":["import { AdminLayout } from '@/components/AdminLayout'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Shield, Users } from 'lucide-react'\nimport { useEffect, useState } from 'react'\nimport { fetchWithAuth } from '@/lib/auth'\nimport { useToast } from '@/components/ui/use-toast'\n\ninterface RoleStats {\n  id: number\n  name: string\n  description: string\n  count: number\n  percentage: string\n}\n\ninterface StatsData {\n  total_users: number\n  roles: RoleStats[]\n}\n\nexport default function RolesPage() {\n  const [stats, setStats] = useState<StatsData | null>(null)\n  const [loading, setLoading] = useState(true)\n  const { toast } = useToast()\n\n  useEffect(() => {\n    fetchStats()\n  }, [])\n\n  const fetchStats = async () => {\n    try {\n      const response = await fetchWithAuth('/api/roles/stats')\n      if (response.ok) {\n        const data = await response.json()\n        setStats(data)\n      } else {\n        const errorData = await response.json().catch(() => ({}))\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: errorData.message || 'Error al cargar estadísticas de roles'\n        })\n      }\n    } catch (error) {\n      console.error('[RolesPage] Error:', error)\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red al cargar estadísticas'\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const getRoleDisplayName = (name: string) => {\n    const names: Record<string, string> = {\n      'root': 'Administrador',\n      'admin_employee': 'Empleado de Administración',\n      'library_employee': 'Empleado de Biblioteca',\n      'new_user': 'Usuario Nuevo',\n      'readonly': 'Solo Lectura'\n    }\n    return names[name] || name\n  }\n\n  const getRoleBadgeColor = (name: string) => {\n    const colors: Record<string, string> = {\n      'root': 'bg-purple-100 text-purple-800 border-purple-200',\n      'admin_employee': 'bg-blue-100 text-blue-800 border-blue-200',\n      'library_employee': 'bg-green-100 text-green-800 border-green-200',\n      'new_user': 'bg-yellow-100 text-yellow-800 border-yellow-200',\n      'readonly': 'bg-gray-100 text-gray-800 border-gray-200'\n    }\n    return colors[name] || 'bg-gray-100 text-gray-800 border-gray-200'\n  }\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Roles y Permisos</h1>\n            <p className=\"mt-2 text-gray-600\">Gestionar roles del sistema y distribución de usuarios</p>\n          </div>\n        </div>\n\n        {loading ? (\n          <Card>\n            <CardContent className=\"py-8\">\n              <div className=\"text-center text-gray-500\">Cargando...</div>\n            </CardContent>\n          </Card>\n        ) : (\n          <>\n            {/* Summary Card */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Users className=\"h-5 w-5 text-blue-600\" />\n                    Total de Usuarios\n                  </CardTitle>\n                  <CardDescription>Usuarios registrados en el sistema</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-4xl font-bold text-gray-900\">{stats?.total_users || 0}</div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Shield className=\"h-5 w-5 text-purple-600\" />\n                    Roles Disponibles\n                  </CardTitle>\n                  <CardDescription>Roles configurados en el sistema</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-4xl font-bold text-gray-900\">{stats?.roles.length || 0}</div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Roles Distribution */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Distribución de Usuarios por Rol</CardTitle>\n                <CardDescription>Cantidad y porcentaje de usuarios en cada rol</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  {stats?.roles.map((role) => (\n                    <div key={role.id} className=\"border rounded-lg p-4 hover:bg-gray-50 transition-colors\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <div className=\"flex items-center gap-3\">\n                          <Shield className=\"h-5 w-5 text-gray-400\" />\n                          <div>\n                            <span className={`inline-block px-3 py-1 rounded-full text-sm font-medium border ${getRoleBadgeColor(role.name)}`}>\n                              {getRoleDisplayName(role.name)}\n                            </span>\n                            {role.description && (\n                              <p className=\"text-sm text-gray-600 mt-1\">{role.description}</p>\n                            )}\n                          </div>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className=\"text-2xl font-bold text-gray-900\">{role.count}</div>\n                          <div className=\"text-sm text-gray-500\">{role.percentage}%</div>\n                        </div>\n                      </div>\n\n                      {/* Progress Bar */}\n                      <div className=\"w-full bg-gray-200 rounded-full h-2 mt-3\">\n                        <div\n                          className={`h-2 rounded-full ${\n                            role.name === 'root' ? 'bg-purple-600' :\n                            role.name === 'admin_employee' ? 'bg-blue-600' :\n                            role.name === 'library_employee' ? 'bg-green-600' :\n                            role.name === 'new_user' ? 'bg-yellow-600' :\n                            'bg-gray-600'\n                          }`}\n                          style={{ width: `${role.percentage}%` }}\n                        />\n                      </div>\n                    </div>\n                  ))}\n\n                  {(!stats?.roles || stats.roles.length === 0) && (\n                    <div className=\"text-center py-8 text-gray-500\">\n                      No se encontraron roles configurados\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Info Card */}\n            <Card className=\"border-blue-200 bg-blue-50\">\n              <CardHeader>\n                <CardTitle className=\"text-blue-900\">Información sobre Roles</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <ul className=\"space-y-2 text-sm text-blue-800\">\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"font-bold mt-0.5\">•</span>\n                    <span><strong>Administrador:</strong> Acceso completo al sistema, puede realizar cualquier operación</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"font-bold mt-0.5\">•</span>\n                    <span><strong>Empleado de Administración:</strong> Puede gestionar usuarios, roles y configuraciones del sistema</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"font-bold mt-0.5\">•</span>\n                    <span><strong>Empleado de Biblioteca:</strong> Usuario aprobado con acceso a funciones de la biblioteca</span>\n                  </li>\n                  <li className=\"flex items-start gap-2\">\n                    <span className=\"font-bold mt-0.5\">•</span>\n                    <span><strong>Usuario Nuevo:</strong> Cuenta creada pero pendiente de aprobación por un administrador</span>\n                  </li>\n                </ul>\n              </CardContent>\n            </Card>\n          </>\n        )}\n      </div>\n    </AdminLayout>\n  )\n}\n"],"names":["RolesPage","stats","setStats","useState","loading","setLoading","toast","useToast","useEffect","fetchStats","response","fetchWithAuth","data","errorData","error","getRoleDisplayName","name","getRoleBadgeColor","jsx","AdminLayout","jsxs","Card","CardContent","Fragment","CardHeader","CardTitle","Users","CardDescription","Shield","role"],"mappings":"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"}