{"version":3,"file":"UsersPage-B6PmQ_S6.js","sources":["../../node_modules/lucide-react/dist/esm/icons/mail-check.js","../../node_modules/lucide-react/dist/esm/icons/square-pen.js","../../node_modules/lucide-react/dist/esm/icons/trash-2.js","../../src/pages/admin/UsersPage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8\", key: \"12jkf8\" }],\n  [\"path\", { d: \"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7\", key: \"1ocrg3\" }],\n  [\"path\", { d: \"m16 19 2 2 4-4\", key: \"1b14m6\" }]\n];\nconst MailCheck = createLucideIcon(\"mail-check\", __iconNode);\n\nexport { __iconNode, MailCheck as default };\n//# sourceMappingURL=mail-check.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\", key: \"1m0v6g\" }],\n  [\n    \"path\",\n    {\n      d: \"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z\",\n      key: \"ohrbg2\"\n    }\n  ]\n];\nconst SquarePen = createLucideIcon(\"square-pen\", __iconNode);\n\nexport { __iconNode, SquarePen as default };\n//# sourceMappingURL=square-pen.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M10 11v6\", key: \"nco0om\" }],\n  [\"path\", { d: \"M14 11v6\", key: \"outv1u\" }],\n  [\"path\", { d: \"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6\", key: \"miytrc\" }],\n  [\"path\", { d: \"M3 6h18\", key: \"d0wm0j\" }],\n  [\"path\", { d: \"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\", key: \"e791ji\" }]\n];\nconst Trash2 = createLucideIcon(\"trash-2\", __iconNode);\n\nexport { __iconNode, Trash2 as default };\n//# sourceMappingURL=trash-2.js.map\n","import { AdminLayout } from '@/components/AdminLayout'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { useToast } from '@/components/ui/use-toast'\nimport { Edit, Plus, Trash2, Search, Key, Mail, MailCheck, CheckCircle, RefreshCw, UserCheck } from 'lucide-react'\nimport { useEffect, useState } from 'react'\nimport { fetchWithAuth, authService } from '@/lib/auth'\nimport { PasswordStrengthIndicator } from '@/components/PasswordStrengthIndicator'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Switch } from '@/components/ui/switch'\n\ninterface User {\n  id: number\n  username: string\n  email: string\n  nombre?: string\n  apellido?: string\n  email_verified?: boolean\n  active?: boolean\n  role?: string\n  role_id?: number\n  created_at: string\n}\n\ninterface Role {\n  id: number\n  name: string\n  description: string\n}\n\ninterface UserFormData {\n  username: string\n  email: string\n  nombre: string\n  apellido: string\n  password: string\n}\n\nexport default function UsersPage() {\n  const [users, setUsers] = useState<User[]>([])\n  const [roles, setRoles] = useState<Role[]>([])\n  const [loading, setLoading] = useState(true)\n  const [searchTerm, setSearchTerm] = useState('')\n  const [isDialogOpen, setIsDialogOpen] = useState(false)\n  const [isEditMode, setIsEditMode] = useState(false)\n  const [currentUser, setCurrentUser] = useState<User | null>(null)\n  const [formData, setFormData] = useState<UserFormData>({\n    username: '',\n    email: '',\n    nombre: '',\n    apellido: '',\n    password: ''\n  })\n  const [passwordValidation, setPasswordValidation] = useState<any>(null)\n\n  // New dialogs state\n  const [isResetPasswordDialogOpen, setIsResetPasswordDialogOpen] = useState(false)\n  const [isChangeEmailDialogOpen, setIsChangeEmailDialogOpen] = useState(false)\n  const [temporaryPassword, setTemporaryPassword] = useState('')\n  const [newEmail, setNewEmail] = useState('')\n\n  const { toast} = useToast()\n\n  // Check if current user is root (only root can edit users)\n  const currentUserData = authService.getUser()\n  const isRoot = currentUserData?.role === 'root'\n\n  // Helper function to translate role names\n  const translateRoleName = (roleName: string) => {\n    const translations: Record<string, string> = {\n      'root': 'Administrador',\n      'admin_employee': 'Empleado de Administración',\n      'library_employee': 'Empleado de Biblioteca',\n      'new_user': 'Usuario Nuevo',\n      'readonly': 'Solo Lectura'\n    }\n    return translations[roleName] || roleName\n  }\n\n  useEffect(() => {\n    fetchUsers()\n    fetchRoles()\n  }, [])\n\n  const fetchUsers = async () => {\n    try {\n      console.log('[UsersPage] Fetching users...')\n      const response = await fetchWithAuth('/api/admin/users')\n      console.log('[UsersPage] Response received:', response.status)\n\n      if (response.ok) {\n        const data = await response.json()\n        console.log('[UsersPage] Users data:', data)\n        setUsers(data)\n      } else {\n        const errorData = await response.json().catch(() => ({}))\n        console.error('[UsersPage] Error response:', errorData)\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: errorData.message || 'Error al cargar usuarios'\n        })\n      }\n    } catch (error) {\n      console.error('[UsersPage] Exception:', error)\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red al cargar usuarios'\n      })\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleCreateUser = () => {\n    setIsEditMode(false)\n    setCurrentUser(null)\n    setFormData({ username: '', email: '', nombre: '', apellido: '', password: '' })\n    setIsDialogOpen(true)\n  }\n\n  const handleEditUser = (user: User) => {\n    setIsEditMode(true)\n    setCurrentUser(user)\n    setFormData({\n      username: user.username,\n      email: user.email,\n      nombre: user.nombre || '',\n      apellido: user.apellido || '',\n      password: ''\n    })\n    setIsDialogOpen(true)\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n\n    // Validate password strength when creating a new user or when changing password\n    if (formData.password && (!passwordValidation || !passwordValidation.valid)) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'La contraseña no cumple con los requisitos de seguridad'\n      })\n      return\n    }\n\n    try {\n      const csrfRes = await fetch('/api/csrf-token', {\n        credentials: 'include'\n      })\n      const { csrfToken } = await csrfRes.json()\n\n      const url = isEditMode ? `/api/admin/users/${currentUser?.id}` : '/api/admin/users'\n      const method = isEditMode ? 'PUT' : 'POST'\n\n      const response = await fetchWithAuth(url, {\n        method,\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRF-Token': csrfToken\n        },\n        body: JSON.stringify(formData)\n      })\n\n      if (response.ok) {\n        toast({\n          variant: 'success',\n          title: 'Éxito',\n          description: `Usuario ${isEditMode ? 'actualizado' : 'creado'} exitosamente`\n        })\n        setIsDialogOpen(false)\n        fetchUsers()\n      } else {\n        const error = await response.json()\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: error.message || 'Operación fallida'\n        })\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red'\n      })\n    }\n  }\n\n  const handleDeleteUser = async (userId: number, username: string) => {\n    // Protect admin account\n    if (username === 'admin') {\n      toast({\n        variant: 'destructive',\n        title: 'No se puede eliminar admin',\n        description: 'La cuenta \"admin\" está protegida y no se puede eliminar'\n      })\n      return\n    }\n\n    if (!confirm('¿Estás seguro de que quieres eliminar este usuario?')) return\n\n    try {\n      const csrfRes = await fetch('/api/csrf-token', {\n        credentials: 'include'\n      })\n      const { csrfToken } = await csrfRes.json()\n\n      const response = await fetchWithAuth(`/api/admin/users/${userId}`, {\n        method: 'DELETE',\n        headers: {\n          'X-CSRF-Token': csrfToken\n        }\n      })\n\n      if (response.ok) {\n        toast({\n          variant: 'success',\n          title: 'Éxito',\n          description: 'Usuario eliminado exitosamente'\n        })\n        fetchUsers()\n      } else {\n        const errorData = await response.json().catch(() => ({}))\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: errorData.message || 'Error al eliminar usuario'\n        })\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red'\n      })\n    }\n  }\n\n  // Reset password with temporary password\n  const handleResetPassword = (user: User) => {\n    setCurrentUser(user)\n    setTemporaryPassword('')\n    setIsResetPasswordDialogOpen(true)\n  }\n\n  const handleResetPasswordSubmit = async () => {\n    if (!currentUser || !temporaryPassword) return\n\n    try {\n      const csrfRes = await fetch('/api/csrf-token', { credentials: 'include' })\n      const { csrfToken } = await csrfRes.json()\n\n      const response = await fetchWithAuth(`/api/admin/users/${currentUser.id}/reset-password`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRF-Token': csrfToken\n        },\n        body: JSON.stringify({ temporaryPassword })\n      })\n\n      if (response.ok) {\n        const data = await response.json()\n        toast({\n          title: 'Contraseña restablecida',\n          description: data.warning || 'Contraseña temporal establecida exitosamente'\n        })\n        setIsResetPasswordDialogOpen(false)\n        setTemporaryPassword('')\n      } else {\n        const error = await response.json()\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: error.message || 'Error al restablecer contraseña'\n        })\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red'\n      })\n    }\n  }\n\n  // Verify email manually\n  const handleVerifyEmail = async (userId: number, username: string) => {\n    if (!confirm(`¿Marcar el email de ${username} como verificado?`)) return\n\n    try {\n      const csrfRes = await fetch('/api/csrf-token', { credentials: 'include' })\n      const { csrfToken } = await csrfRes.json()\n\n      const response = await fetchWithAuth(`/api/admin/users/${userId}/verify-email`, {\n        method: 'POST',\n        headers: {\n          'X-CSRF-Token': csrfToken\n        }\n      })\n\n      if (response.ok) {\n        toast({\n          title: 'Email verificado',\n          description: 'El email ha sido marcado como verificado'\n        })\n        fetchUsers()\n      } else {\n        const error = await response.json()\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: error.message || 'Error al verificar email'\n        })\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red'\n      })\n    }\n  }\n\n  // Resend verification email\n  const handleResendVerification = async (userId: number, email: string) => {\n    if (!confirm(`¿Reenviar email de verificación a ${email}?`)) return\n\n    try {\n      const csrfRes = await fetch('/api/csrf-token', { credentials: 'include' })\n      const { csrfToken } = await csrfRes.json()\n\n      const response = await fetchWithAuth(`/api/admin/users/${userId}/resend-verification`, {\n        method: 'POST',\n        headers: {\n          'X-CSRF-Token': csrfToken\n        }\n      })\n\n      if (response.ok) {\n        toast({\n          title: 'Email enviado',\n          description: 'Email de verificación reenviado exitosamente'\n        })\n      } else {\n        const error = await response.json()\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: error.message || 'Error al reenviar email'\n        })\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red'\n      })\n    }\n  }\n\n  // Change email\n  const handleChangeEmail = (user: User) => {\n    setCurrentUser(user)\n    setNewEmail(user.email)\n    setIsChangeEmailDialogOpen(true)\n  }\n\n  const handleChangeEmailSubmit = async () => {\n    if (!currentUser || !newEmail) return\n\n    try {\n      const csrfRes = await fetch('/api/csrf-token', { credentials: 'include' })\n      const { csrfToken } = await csrfRes.json()\n\n      const response = await fetchWithAuth(`/api/admin/users/${currentUser.id}/change-email`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRF-Token': csrfToken\n        },\n        body: JSON.stringify({ newEmail })\n      })\n\n      if (response.ok) {\n        const data = await response.json()\n        toast({\n          title: 'Email cambiado',\n          description: data.warning || 'Email actualizado exitosamente'\n        })\n        setIsChangeEmailDialogOpen(false)\n        setNewEmail('')\n        fetchUsers()\n      } else {\n        const error = await response.json()\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: error.message || 'Error al cambiar email'\n        })\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red'\n      })\n    }\n  }\n\n  // Fetch available roles\n  const fetchRoles = async () => {\n    try {\n      const response = await fetchWithAuth('/api/roles')\n      if (response.ok) {\n        const data = await response.json()\n        setRoles(data.roles || [])\n      }\n    } catch (error) {\n      console.error('[UsersPage] Error fetching roles:', error)\n    }\n  }\n\n  // Approve account\n  const handleApproveAccount = async (userId: number, username: string) => {\n    if (!confirm(`¿Aprobar la cuenta de ${username}?`)) return\n\n    try {\n      const csrfRes = await fetch('/api/csrf-token', { credentials: 'include' })\n      const { csrfToken } = await csrfRes.json()\n\n      const response = await fetchWithAuth(`/api/admin/users/${userId}/approve`, {\n        method: 'POST',\n        headers: {\n          'X-CSRF-Token': csrfToken\n        }\n      })\n\n      if (response.ok) {\n        toast({\n          title: 'Cuenta aprobada',\n          description: 'La cuenta ha sido activada exitosamente'\n        })\n        fetchUsers()\n      } else {\n        const error = await response.json()\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: error.message || 'Error al aprobar cuenta'\n        })\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red'\n      })\n    }\n  }\n\n  // Change user role\n  const handleRoleChange = async (userId: number, username: string, newRoleId: string) => {\n    try {\n      const csrfRes = await fetch('/api/csrf-token', { credentials: 'include' })\n      const { csrfToken } = await csrfRes.json()\n\n      const response = await fetchWithAuth(`/api/roles/user/${userId}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRF-Token': csrfToken\n        },\n        body: JSON.stringify({ role_id: parseInt(newRoleId) })\n      })\n\n      if (response.ok) {\n        const data = await response.json()\n        toast({\n          title: 'Rol actualizado',\n          description: `Rol de ${username} cambiado de ${translateRoleName(data.user.old_role)} a ${translateRoleName(data.user.new_role)}`\n        })\n        fetchUsers()\n      } else {\n        const error = await response.json()\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: error.message || 'Error al cambiar rol'\n        })\n        fetchUsers() // Revert UI\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red'\n      })\n      fetchUsers() // Revert UI\n    }\n  }\n\n  // Toggle active status\n  const handleToggleActive = async (userId: number, username: string, currentStatus: boolean) => {\n    try {\n      const csrfRes = await fetch('/api/csrf-token', { credentials: 'include' })\n      const { csrfToken } = await csrfRes.json()\n\n      const response = await fetchWithAuth(`/api/admin/users/${userId}/toggle-active`, {\n        method: 'PATCH',\n        headers: {\n          'X-CSRF-Token': csrfToken\n        }\n      })\n\n      if (response.ok) {\n        const data = await response.json()\n        toast({\n          title: data.message,\n          description: `Cuenta de ${username} ${!currentStatus ? 'activada' : 'desactivada'}`\n        })\n        fetchUsers()\n      } else {\n        const error = await response.json()\n        toast({\n          variant: 'destructive',\n          title: 'Error',\n          description: error.message || 'Error al cambiar estado'\n        })\n        fetchUsers() // Revert UI\n      }\n    } catch (error) {\n      toast({\n        variant: 'destructive',\n        title: 'Error',\n        description: 'Error de red'\n      })\n      fetchUsers() // Revert UI\n    }\n  }\n\n  const filteredUsers = users.filter(user =>\n    user.username.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    user.email.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    (user.nombre && user.nombre.toLowerCase().includes(searchTerm.toLowerCase())) ||\n    (user.apellido && user.apellido.toLowerCase().includes(searchTerm.toLowerCase()))\n  )\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Usuarios</h1>\n            <p className=\"mt-2 text-gray-600\">Gestionar usuarios del sistema y permisos</p>\n          </div>\n          {isRoot && (\n            <Button onClick={handleCreateUser}>\n              <Plus className=\"mr-2 h-4 w-4\" />\n              Agregar Usuario\n            </Button>\n          )}\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Lista de Usuarios</CardTitle>\n            <CardDescription>Todos los usuarios registrados en el sistema</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"mb-4\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\n                <Input\n                  placeholder=\"Buscar usuarios...\"\n                  className=\"pl-10\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                />\n              </div>\n            </div>\n\n            {loading ? (\n              <div className=\"text-center py-8\">Cargando...</div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead>\n                    <tr className=\"border-b\">\n                      <th className=\"text-left py-3 px-4 font-medium text-sm\">Nombre de usuario</th>\n                      <th className=\"text-center py-3 px-4 font-medium text-sm\">Email</th>\n                      <th className=\"text-left py-3 px-4 font-medium text-sm\">Rol</th>\n                      <th className=\"text-center py-3 px-4 font-medium text-sm\">Estado</th>\n                      <th className=\"text-left py-3 px-4 font-medium text-sm\">Creado</th>\n                      <th className=\"text-right py-3 px-4 font-medium text-sm\">Acciones</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredUsers.map((user) => (\n                      <tr key={user.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"py-3 px-4 text-sm font-medium\">{user.username}</td>\n                        <td className=\"py-3 px-4 text-sm\">\n                          <div className=\"flex items-center justify-center gap-1\">\n                            <a\n                              href={`mailto:${user.email}`}\n                              title={user.email}\n                              className=\"inline-flex items-center justify-center h-8 w-8 rounded-lg hover:bg-blue-50 transition-colors\"\n                            >\n                              <Mail className=\"h-4 w-4 text-blue-600\" />\n                            </a>\n                            {user.username !== 'admin' && (\n                              <>\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"icon\"\n                                  onClick={() => handleChangeEmail(user)}\n                                  title=\"Cambiar email\"\n                                  className=\"h-8 w-8\"\n                                >\n                                  <RefreshCw className=\"h-4 w-4 text-purple-600\" />\n                                </Button>\n                                {!user.email_verified && (\n                                  <>\n                                    <Button\n                                      variant=\"ghost\"\n                                      size=\"icon\"\n                                      onClick={() => handleVerifyEmail(user.id, user.username)}\n                                      title=\"Marcar email como verificado\"\n                                      className=\"h-8 w-8\"\n                                    >\n                                      <MailCheck className=\"h-4 w-4 text-green-600\" />\n                                    </Button>\n                                    <Button\n                                      variant=\"ghost\"\n                                      size=\"icon\"\n                                      onClick={() => handleResendVerification(user.id, user.email)}\n                                      title=\"Reenviar email de verificación\"\n                                      className=\"h-8 w-8\"\n                                    >\n                                      <Mail className=\"h-4 w-4 text-orange-600\" />\n                                    </Button>\n                                  </>\n                                )}\n                              </>\n                            )}\n                          </div>\n                        </td>\n                        <td className=\"py-3 px-4 text-sm\">\n                          {user.username === 'admin' || !isRoot ? (\n                            <span className=\"inline-block px-3 py-2 text-sm text-gray-700 bg-gray-100 rounded-md\">\n                              {user.role ? translateRoleName(user.role) : 'Sin rol'}\n                            </span>\n                          ) : (\n                            <Select\n                              value={user.role_id?.toString() || ''}\n                              onValueChange={(value) => handleRoleChange(user.id, user.username, value)}\n                            >\n                              <SelectTrigger className=\"w-full max-w-[200px] text-left\">\n                                <SelectValue placeholder=\"Seleccionar rol\">\n                                  {user.role ? translateRoleName(user.role) : 'Sin rol'}\n                                </SelectValue>\n                              </SelectTrigger>\n                              <SelectContent>\n                                {roles.map((role) => (\n                                  <SelectItem key={role.id} value={role.id.toString()}>\n                                    {translateRoleName(role.name)}\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                          )}\n                        </td>\n                        <td className=\"py-3 px-4 text-sm text-center\">\n                          <div className=\"flex items-center justify-center gap-2\">\n                            <Switch\n                              checked={user.active ?? true}\n                              onCheckedChange={() => handleToggleActive(user.id, user.username, user.active ?? true)}\n                              disabled={user.username === 'admin' || !isRoot}\n                            />\n                            <span className=\"text-xs text-gray-600\">\n                              {user.active ? 'Activo' : 'Inactivo'}\n                            </span>\n                          </div>\n                        </td>\n                        <td className=\"py-3 px-4 text-sm text-gray-600\">\n                          {new Date(user.created_at).toLocaleDateString()}\n                        </td>\n                        <td className=\"py-3 px-4 text-sm text-right\">\n                          {user.username === 'admin' ? (\n                            <div className=\"flex justify-end gap-1 flex-wrap\">\n                              <span className=\"text-xs text-gray-500 italic px-2 py-1\">\n                                Cuenta protegida\n                              </span>\n                            </div>\n                          ) : (\n                            <div className=\"flex justify-end gap-1 flex-wrap\">\n                              <Button\n                                variant=\"ghost\"\n                                size=\"icon\"\n                                onClick={() => handleResetPassword(user)}\n                                title=\"Establecer contraseña temporal\"\n                              >\n                                <Key className=\"h-4 w-4 text-blue-600\" />\n                              </Button>\n                              <Button\n                                variant=\"ghost\"\n                                size=\"icon\"\n                                onClick={() => handleEditUser(user)}\n                                title=\"Editar usuario\"\n                              >\n                                <Edit className=\"h-4 w-4\" />\n                              </Button>\n                              <Button\n                                variant=\"ghost\"\n                                size=\"icon\"\n                                onClick={() => handleDeleteUser(user.id, user.username)}\n                                title=\"Eliminar usuario\"\n                              >\n                                <Trash2 className=\"h-4 w-4 text-red-600\" />\n                              </Button>\n                            </div>\n                          )}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n\n                {filteredUsers.length === 0 && (\n                  <div className=\"text-center py-8 text-gray-500\">\n                    No se encontraron usuarios\n                  </div>\n                )}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>{isEditMode ? 'Editar Usuario' : 'Crear Nuevo Usuario'}</DialogTitle>\n              <DialogDescription>\n                {isEditMode ? 'Actualizar información del usuario' : 'Agregar un nuevo usuario al sistema'}\n              </DialogDescription>\n            </DialogHeader>\n            <form onSubmit={handleSubmit}>\n              <div className=\"space-y-4 py-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"username\">Nombre de usuario</Label>\n                  <Input\n                    id=\"username\"\n                    required\n                    value={formData.username}\n                    onChange={(e) => setFormData({ ...formData, username: e.target.value })}\n                    disabled={isEditMode && currentUser?.username === 'admin'}\n                    className={isEditMode && currentUser?.username === 'admin' ? 'bg-gray-100 cursor-not-allowed' : ''}\n                  />\n                  {isEditMode && currentUser?.username === 'admin' && (\n                    <p className=\"text-xs text-gray-500\">\n                      El nombre de usuario admin no se puede cambiar por razones de seguridad\n                    </p>\n                  )}\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\">Correo electrónico</Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    required\n                    value={formData.email}\n                    onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"nombre\">Nombre</Label>\n                  <Input\n                    id=\"nombre\"\n                    value={formData.nombre}\n                    onChange={(e) => setFormData({ ...formData, nombre: e.target.value })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"apellido\">Apellido</Label>\n                  <Input\n                    id=\"apellido\"\n                    value={formData.apellido}\n                    onChange={(e) => setFormData({ ...formData, apellido: e.target.value })}\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"password\">Contraseña {isEditMode && '(dejar en blanco para mantener la actual)'}</Label>\n                  <Input\n                    id=\"password\"\n                    type=\"password\"\n                    required={!isEditMode}\n                    value={formData.password}\n                    onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                  />\n                  {formData.password && (\n                    <PasswordStrengthIndicator\n                      password={formData.password}\n                      onValidationChange={setPasswordValidation}\n                    />\n                  )}\n                </div>\n              </div>\n              <DialogFooter>\n                <Button type=\"button\" variant=\"outline\" onClick={() => setIsDialogOpen(false)}>\n                  Cancelar\n                </Button>\n                <Button type=\"submit\">\n                  {isEditMode ? 'Actualizar' : 'Crear'}\n                </Button>\n              </DialogFooter>\n            </form>\n          </DialogContent>\n        </Dialog>\n\n        {/* Reset Password Dialog */}\n        <Dialog open={isResetPasswordDialogOpen} onOpenChange={setIsResetPasswordDialogOpen}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>Establecer Contraseña Temporal</DialogTitle>\n              <DialogDescription>\n                Establecer una contraseña temporal para {currentUser?.username}. El usuario deberá cambiarla en su próximo inicio de sesión.\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"temp-password\">Contraseña Temporal</Label>\n                <Input\n                  id=\"temp-password\"\n                  type=\"text\"\n                  placeholder=\"Ingresa una contraseña temporal\"\n                  value={temporaryPassword}\n                  onChange={(e) => setTemporaryPassword(e.target.value)}\n                  autoComplete=\"off\"\n                />\n                <p className=\"text-xs text-gray-500\">\n                  Esta contraseña será visible para el administrador. Compártela de forma segura con el usuario.\n                </p>\n              </div>\n            </div>\n            <DialogFooter>\n              <Button type=\"button\" variant=\"outline\" onClick={() => setIsResetPasswordDialogOpen(false)}>\n                Cancelar\n              </Button>\n              <Button\n                type=\"button\"\n                onClick={handleResetPasswordSubmit}\n                disabled={!temporaryPassword}\n              >\n                Establecer Contraseña\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Change Email Dialog */}\n        <Dialog open={isChangeEmailDialogOpen} onOpenChange={setIsChangeEmailDialogOpen}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>Cambiar Email</DialogTitle>\n              <DialogDescription>\n                Cambiar el email de {currentUser?.username}. Se enviará un email de verificación a la nueva dirección.\n              </DialogDescription>\n            </DialogHeader>\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"current-email\">Email Actual</Label>\n                <Input\n                  id=\"current-email\"\n                  type=\"email\"\n                  value={currentUser?.email || ''}\n                  disabled\n                  className=\"bg-gray-100\"\n                />\n              </div>\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"new-email\">Nuevo Email</Label>\n                <Input\n                  id=\"new-email\"\n                  type=\"email\"\n                  placeholder=\"nuevo@email.com\"\n                  value={newEmail}\n                  onChange={(e) => setNewEmail(e.target.value)}\n                />\n                <p className=\"text-xs text-gray-500\">\n                  El email será marcado como no verificado y se enviará un email de verificación.\n                </p>\n              </div>\n            </div>\n            <DialogFooter>\n              <Button type=\"button\" variant=\"outline\" onClick={() => setIsChangeEmailDialogOpen(false)}>\n                Cancelar\n              </Button>\n              <Button\n                type=\"button\"\n                onClick={handleChangeEmailSubmit}\n                disabled={!newEmail || newEmail === currentUser?.email}\n              >\n                Cambiar Email\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </div>\n    </AdminLayout>\n  )\n}\n"],"names":["__iconNode","MailCheck","createLucideIcon","SquarePen","Trash2","UsersPage","users","setUsers","useState","roles","setRoles","loading","setLoading","searchTerm","setSearchTerm","isDialogOpen","setIsDialogOpen","isEditMode","setIsEditMode","currentUser","setCurrentUser","formData","setFormData","passwordValidation","setPasswordValidation","isResetPasswordDialogOpen","setIsResetPasswordDialogOpen","isChangeEmailDialogOpen","setIsChangeEmailDialogOpen","temporaryPassword","setTemporaryPassword","newEmail","setNewEmail","toast","useToast","currentUserData","authService","isRoot","translateRoleName","roleName","useEffect","fetchUsers","fetchRoles","response","fetchWithAuth","data","errorData","error","handleCreateUser","handleEditUser","user","handleSubmit","e","csrfRes","csrfToken","url","handleDeleteUser","userId","username","handleResetPassword","handleResetPasswordSubmit","handleVerifyEmail","handleResendVerification","email","handleChangeEmail","handleChangeEmailSubmit","handleRoleChange","newRoleId","handleToggleActive","currentStatus","filteredUsers","jsx","AdminLayout","jsxs","Button","Plus","Card","CardHeader","CardTitle","CardDescription","CardContent","Search","Input","Mail","Fragment","RefreshCw","Select","_a","value","SelectTrigger","SelectValue","SelectContent","role","SelectItem","Switch","Key","Edit","Dialog","DialogContent","DialogHeader","DialogTitle","DialogDescription","Label","PasswordStrengthIndicator","DialogFooter"],"mappings":"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","x_google_ignoreList":[0,1,2]}